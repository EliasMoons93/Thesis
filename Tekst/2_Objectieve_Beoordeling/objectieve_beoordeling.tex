\chapter{Objectieve Beoordeling Muziekstuk}
\label{hoofdstuk:OBM}
Om melodische transformaties te kunnen beoordelen is er nood aan een framework dat kan voorspellen of een gegeven melodie al dan niet goed klinkt. In dit hoofdstuk worden twee zo een modellen besproken die een bepaalde `consonantiescore' (maat voor het goed klinken van een muziekstuk) gaan toekennen aan een muziekstuk. Allereerst wordt een aanpak besproken die gebruik maakt van een artifici\"eel neuraal netwerk \cite{book:ANN}. Deze methode is speciaal gemaakt voor het beoordelen van polyfone muziek, waarbij er meerdere noten tegelijk klinken. Polyfone muziek wordt in verdere hoofdstukken van deze masterproef niet meer besproken. Het eerste onderdeel van dit hoofdstuk zal bijgevolg dus weinig invloed hebben op het vervolg van de tekst. De methode is echter wel onderzocht geweest en leverde enkele interessante resultaten op waardoor de methode toch even in het kort vermeld wordt. Als tweede methode wordt een zogenaamd `RPK-Model' besproken dat gebaseerd is op een gelijknamig model uit het boek `Music and Probability' \cite{book:musicAndProbability} van David Temperley \cite{url:temperley}. Dit model werkt op muziek met een enkele melodielijn en zal ook het model zijn dat als verificator gebruikt zal worden bij de experimenten in het vervolg van deze masterproef.

\section{Neuraal Netwerk}
\label{OBM:NN}
In het boek `Musimathics' \cite{book:musimathics} wordt er een gedeelte gewijd aan het meten van de consonantie van akkoorden (samenklank van meerdere noten). Dit gebeurt kort samengevat door het trainen van een neuraal netwerk op zogenaamde tweeklanken (twee noten die tegelijkertijd gespeeld worden). Het neuraal netwerk maakt dan de veralgemening naar hogere orde samenklanken. Het neuraal netwerk dat gemaakt werd als verificator bestond uit drie lagen. een invoerlaag, een uitvoerlaag en dan nog een verborgen laag. De invoerlaag bestond uit 12 neurons die elk voor een van de 12 verschillende noten staan. Twee noten die een octaaf uit elkaar liggen (en muziektechnisch dezelfde naam krijgen) zullen dus ook op eenzelfde neuron afgebeeld worden. Deze 12 input neurons krijgen een `1' als input wanneer er een noot in het akkoord zit dat afgebeeld wordt op die neuron. In het andere geval krijgt deze een `0' als input. Vervolgens komen we op een hidden layer terecht die volledige geconnecteerd is en uit 6 neurons bestaat. Tot slot komen we nog bij de output layer uit die uit slechts 1 neuron bestaat. Deze neuron gaat een getal tussen 0 en 1 teruggeven, hoe dichter het getal bij 1 ligt hoe zekerder het neuraal netwerk is dat het ingegeven akkoord consonant is. Hoe dichte bij 0 hoe zekerder hij is dat het akkoord dissonant (tegengestelde van consonant) is.\\
Dit netwerk werd getraind op alle mogelijke tweeklanken gebruik makend van de \textit{backpropagation of error}-methode\cite{url:backpropagation}. Voor elke mogelijke tweeklank werd afhankelijk van de afstand (in halve tonen) tussen de twee noten bepaald of ze goed samen klinken of niet. Dit volgens de regels van de muziektheorie. Deze regels komen ook overeen met de verhoudingen van de frequenties van de twee invoernoten. Hoe kleiner de getallen in de vereenvoudigde breuk van de frequenties, hoe beter het akkoord klinkt. Na het trainen van het neuraal netwerk kan dit gebruikt worden om meerstemmige muziek te gaan beoordelen. Op elk tijdstip waarop er noten gespeeld worden kan men deze noten als input in het neuraal netwerk steken. De uitvoer van het netwerk geeft dan een maat voor de consonantie terug. Als we dit doen voor elk tijdstip in het muziekstuk waarop er noten gespeeld worden en we nemen dan het gemiddelde over al deze tijdstippen krijgen we een maat voor de `gemiddelde consonantie' van het gehele muziekstuk.\\
Nadat het neuraal netwerk getraind werd, bleek het neuraal netwerk goed te generaliseren naar akkoorden met meer dan 2 noten. Dit wil zeggen dat akkoorden van meer dan twee noten die muziektheoretisch `goed' zouden moeten klinken ook door het netwerk als dusdanig beoordeeld werden. Het netwerk kon dus dienen als een soort van alternatieve voorstelling van de regels van de muziektheorie wat de samenklank van akkoorden betreft. Het probleem lag er echter in dat de klassieke werken van Bach \cite{url:bach} en Mozart \cite{url:mozart} waarop getest werd zelf helemaal niet zo consonant waren als oorspronkelijk gedacht. En dit in die mate dat vaak tot een derde van de akkoorden in zo een stuk als dissonant (tegengestelde van consonant) bestempeld worden. Deze akkoorden blijken ook daadwerkelijk dissonant te zijn. Het is slechts door de context, de noten die net voor het akkoord gespeeld worden, dat deze akkoorden in die stukken toch niet als dissonant ervaren worden door de luisteraar. Het neuraal netwerk dat hier gebruikt werd houdt echter geen rekening met deze context. Dit leidt er wel toe dat dit neuraal netwerk niet gebruikt kan worden als verificator, aangezien zelfs muziekstukken van Bach en Mozart door de verificator niet als consonant herkend worden. Het is daarentegen wel nog maar eens een bevestiging van het genie van componisten als Bach en Mozart, de kunst ligt het niet in het volgen van de regels maar in het weten wanneer en hoe de regels gebroken mogen worden.\\
De broncode die geschreven werd voor het trainen van dit neuraal netwerk is beschikbaar in appendix \ref{Broncode:ANN}. Er zijn een aantal parameters die ingesteld kunnen worden in dit algoritme. Er is allereerst het aantal neuronen in de verborgen laag. Er kan ook een waarde voor de `learning rate' opgegeven worden en dan zijn er nog twee parameters die een bias kunnen defini\"eren.

\section{Keuze tussen Polyfone en Monofone Muziek}
\label{OBM:OMM}
In deze thesis wordt gewerkt met transformaties op een muziektheoretische manier (en dus niet fysisch met frequenties). Daarom is wordt er gebruik gemaakt van muziekstukken die in het MusicXML\cite{url:musicxml} formaat beschikbaar zijn. Het nadeel van deze keuze is dat er slechts een beperkt aantal muziekstukken beschikbaar is. Dit in tegenstelling tot bijvoorbeeld het MIDI-formaat\cite{url:midi} waarbij dit niet het geval is. De polyfone(meerstemmige) muziek die beschkbaar is in het juiste formaat bestaat eigenlijk bijna uitsluitend uit klassieke muziek. Verder is er ook nog een redelijk groot corpus beschikbaar van folkmuziek, het zogenaamde Essencorpus\cite{url:essen}. Deze muziek is wel monofoon (eenstemmig). Aangezien de methode met het neuraal netwerk uitgelegd in bovenstaand onderdeel niet voldoende werkte voor de meerstemminge stukken moest er een andere weg ingeslagen worden. Ofwel verder werken met meerstemmige muziek maar met een ander framework dat de context in rekening brengt. Ofwel de focus verleggen naar eenstemmige muziek. Gezien het grootste deel van de meerstemmige muziekstukken klassieke stukken zijn, is de keuze gemaakt om over te schakelen op eenstemmige muziek. Dit omdat de complexiteit van het aanpassen van muziekstukken met meerdere lijnen veel hoger is dan die van muziekstukken met slechts een instrument. Ook omdat klassieke muziekstukken veel delicater zijn om te behandelen dan stukken folkmuziek die enkel uit een melodielijn bestaan. Alle transformaties die zullen besproken worden in de rest van deze masterproef zullen dus ook uit een enkele melodielijn bestaan.

\section{RPK-Model}
\label{OBM:RPK}
Aangezien er nood was aan een framework voor het beoordelen van muziekstukken van slechts een enkele melodielijn werd er uiteindelijk uitgekomen bij het zogenaamde RPK-model. Dit model wordt beschreven in het boek `Music and Probability'\cite{book:musicAndProbability}. Het model dat besproken gaat worden in dit onderdeel en dus ook gebruikt werd in de rest van het onderzoek is gebaseerd op het model uit dit boek. Er werden een aantal vereenvoudigingen gedaan gebaseerd op extra data die beschikbaar is in het MusicXML formaat. Dit RKP-model gaat dus uit van een enkele lijn melodie (er wordt slechts een noot tegelijkertijd gespeeld). De waarschijnlijkheid van een bepaalde noot in een muziekstuk wordt gekenmerkt door de combinatie van 3 kenmerken waar het model naar genoemd is. Allereerst is er de zogenaamde \textit{range}, dit is de afwijking tot een centrale toonhoogte. Deze centrale toonhoogte is de noot die in het midden ligt van de distributie van alle noten uit alle muziekstukken van het beschikbare corpus van folkmuziek. Globaal gezien hebben noten die dicht bij die centrum liggen een grotere waarschijnlijkheid tot voorkomen als noten die verder van dit centrum gelegen zijn. Dit wordt ge\"illustreerd in figuur \ref{figuur:range}, waarbij elke noot voorgesteld wordt door een geheel getal. De centrale C (do) heeft als waarde 60 gekregen. Een eenheid in deze schaal komt overeen met een halve toon, de volgende C krijgt dus als waarde 72 omdat het verschil tussen de deze twee noten 12 halve tonen is. Verder hebben we ook nog de \textit{proximity}, dit heeft te maken met de relatieve afstand tot de voorgaande noot. Bepaalde groottes van sprongen zijn veel waarschijnlijker dan andere. Een sprong met een terts of een kwint komt bijvoorbeeld veel vaker voor dan een sprong van een sext. In het algemeen zijn kleine sprongen veel waarschijnlijker dan grotere. Figuur \ref{figuur:proximity} geeft de frequenties weer waarmee bepaalde intervallen tussen opeenvolgende noten voorkomen in het Essencorpus. Ten slotte wordt er ook nog rekening gehouden met de \textit{key}, oftewel de toonaard van het muziekstuk. Afhankelijk van de toonaard zijn bepaalde noten waarschijnlijker om voor te komen dan andere. Zo is de grondtoon van een toonladder bijvoorbeeld altijd sterk aanwezig terwijl de noot die een halve toon hoger ligt quasi nooit zal voorkomen in het muziekstuk. Ook is er een verschil in profiel tussen majeur en mineur toonaarden, hier wordt ook rekening mee gehouden. Dit wordt ook ge\"illustreed in figuren \ref{figuur:key_major} en \ref{figuur:key_minor} die resprectievelijk voor stukken die in grote en kleine toonaarden staan de distributies van noten uit het Essencorpus weergeeft. De \textit{range}- en \textit{proximity}-waarden worden gemodelleerd door een normaalverdeling rond respectievelijk de centrale en de vorige noot uit het muziekstuk. De \textit{key}-waarde van een noot wordt bepaald aan de hand van de frequentie van voorkomen van deze zijn nootfunctie in alle muziekstukken van het corpus.

\begin{figure}[!ht]
  \centering
  \includegraphics[width=0.75\textwidth]{2_Objectieve_Beoordeling/range}
  \caption{Distributie van alle noten in het Essencorpus.}
  \label{figuur:range}
\end{figure}

\begin{figure}[!ht]
  \centering
  \includegraphics[width=0.75\textwidth]{2_Objectieve_Beoordeling/proximity}
  \caption{proporties van voorkomen van alle intervallen van opeenvolgende noten in het Essencorpus.}
  \label{figuur:proximity}
\end{figure}

\begin{figure}[!ht]
  \centering
  \includegraphics[width=0.75\textwidth]{2_Objectieve_Beoordeling/key_major}
  \caption{proporties van voorkomen in het Essencorpus van nootfuncties in grote toonladder.}
  \label{figuur:key_major}
\end{figure}

\begin{figure}[!ht]
  \centering
  \includegraphics[width=0.75\textwidth]{2_Objectieve_Beoordeling/key_minor}
  \caption{proporties van voorkomen in het Essencorpus van nootfuncties in kleine toonladder.}
  \label{figuur:key_minor}
\end{figure}

%%% Local Variables: 
%%% mode: latex
%%% TeX-master: "masterproef"
%%% End: 
